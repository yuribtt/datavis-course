<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Movies</title>
    <link rel="stylesheet" href="css/dc.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/crossfilter.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="js/dc.js" charset="utf-8"></script>

  </head>
  <body>

    <div> 
      <h1> Bilheterias por Ano </h1>
      <div id="chart1"></div>
      <h1> Bilheterias por Gênero </h1>
      <div id="chart2"></div>
    </div>

  	<script type="text/javascript">

      var barYear = dc.barChart('#chart1');
     var barGenre = dc.barChart('#chart2');

      d3.json("movies.json", function(error, data){

        var facts = crossfilter(data);
        
        var yearDim = facts.dimension(function(d) {
          return d.Year;
        });

        var genreDim = facts.dimension(function(d){
          return d.Genre;
        });
        
        var totalGrossByYearGroup = yearDim.group().reduceSum(function(d){
          return d.Worldwide_Gross_M;
        });

        var totalGrossByGenreGroup = genreDim.group().reduceSum(function(d){
          return d.Worldwide_Gross_M;
        });
        
        barYear
          .width(768)
          .height(480)
          .x(d3.scale.linear().domain([2005,2017]))
          .brushOn(false)
          .yAxisLabel("Bilheteria em Milhões")
          .dimension(yearDim)
          .group(totalGrossByYearGroup);

        /*barGenre
          .width(768)
          .height(480)
          .x(d3.scale.ordinal())
          .xUnits(dc.units.ordinal)
          .yAxisLabel("Bilheteria em Milhões")
          //.renderHorizontalGridLines(true)
          //.legend(dc.legend().x(700).y(5).itemHeight(13).gap(5))
          .brushOn(false)    
          .group(totalGrossByGenreGroup);
          // .ordering(function(d) {
          //   return -d.Worldwide_Gross_M;
          // });*/
        
        dc.renderAll();        
      });

  	</script>			
  </body>
</html>